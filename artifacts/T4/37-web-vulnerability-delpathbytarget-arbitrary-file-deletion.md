---
firmware: _DIR890LA1_FW111b02_20170519_beta01.bin.extracted
alert: web-vulnerability-delpathbytarget-arbitrary-file-deletion
---

### web-vulnerability-delpathbytarget-arbitrary-file-deletion

- **File/Directory Path:** `REDACTED_PASSWORD_PLACEHOLDER.php`
- **Location:** `delpathbytarget.php:3-7`
- **Risk Score:** 8.5
- **Confidence:** 8.5
- **Description:** A high-risk security vulnerability has been discovered in the 'delpathbytarget.php' file:
1. Unvalidated HTTP parameters ($BASE/$NODE/$TARGET/$VALUE/$POSTFIX) are directly passed to file operation functions
2. These parameters are used to construct file paths and execute deletion operations (del function)
3. Attackers may achieve arbitrary file deletion by crafting malicious parameters

REDACTED_PASSWORD_PLACEHOLDER evidence:
- Vulnerability location: delpathbytarget.php:3-7
- Dangerous parameter transmission path: HTTP parameters → XNODE_getpathbytarget() → del()
- **Code Snippet:**
  ```
  $stsp = XNODE_getpathbytarget($BASE, $NODE, $TARGET, $VALUE, 0);
    del($stsp.'/'.$POSTFIX);
  ```
- **Keywords:** $BASE, $NODE, $TARGET, $VALUE, $POSTFIX, XNODE_getpathbytarget, del
- **Notes:** Limiting factors:
1. Unable to obtain 'phplib/xnode.php' to verify the complete attack chain
2. Need to confirm the specific implementation of the del() function

Recommendations:
1. Implement strict validation for all HTTP parameters
2. Implement path normalization checks
3. Restrict the directory scope for delete operations
