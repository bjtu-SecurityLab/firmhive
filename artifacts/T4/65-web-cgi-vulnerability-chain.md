---
firmware: DIR-868L_fw_revA_1-12_eu_multi_20170316
alert: web-cgi-vulnerability-chain
---

### web-cgi-vulnerability-chain

- **File/Directory Path:** `htdocs/cgibin`
- **Location:** `htdocs/cgibin & htdocs/fileaccess.cgi`
- **Risk Score:** 9.0
- **Confidence:** 8.25
- **Description:** A comprehensive analysis has identified security risks in multiple CGI scripts, forming a complete vulnerability chain:
1. Multiple CGI scripts (dlcfg.cgi, authentication.cgi, etc.) were found in htdocs/cgibin using dangerous functions (system, strcpy, etc.)
2. A strcpy buffer overflow vulnerability was confirmed in fileaccess.cgi (REQUEST_URI parameter copied directly without validation)
3. Potential data flows were discovered between HTTP request handling components (REQUEST_METHOD, CONTENT_LENGTH, etc.) and dangerous functions

Risk: Attackers could potentially trigger command injection or buffer overflow through crafted malicious HTTP requests (GET/POST), enabling remote code execution.
- **Code Snippet:**
  ```
  HIDDEN:
  1. fileaccess.cgiHIDDENstrcpyHIDDEN:
  0x0000b048      mov r1, r2
  0x0000b04c      bl sym.imp.strcpy
  
  2. cgibinHIDDENsystemHIDDEN:
  HIDDEN'/etc/scripts/dlcfg_hlper.sh'
  ```
- **Keywords:** system, strcpy, popen, sprintf, REQUEST_METHOD, REQUEST_URI, CONTENT_LENGTH, HTTP_request, dlcfg.cgi, authentication.cgi, fileaccess.cgi, GET, POST, /etc/scripts/dlcfg_hlper.sh
- **Notes:** At least two independent vulnerability paths have been confirmed:
1. Buffer overflow in strcpy within fileaccess.cgi
2. Potential system command injection in cgibin
It is recommended to prioritize fixing these high-risk vulnerabilities and conduct a comprehensive audit of all CGI scripts.
