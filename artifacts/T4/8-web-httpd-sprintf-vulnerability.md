---
firmware: DIR-868L_fw_revA_1-12_eu_multi_20170316
alert: command-injection-hedwig.cgi-system
---

### command-injection-hedwig.cgi-system

- **File/Directory Path:** `htdocs/cgibin`
- **Location:** `hedwig.cgi: fcn.0001216c @ 0x122b0`
- **Risk Score:** 9.5
- **Confidence:** 8.5
- **Description:** A command injection vulnerability was discovered in hedwig.cgi. The getenv() function retrieves environment variables (which may contain HTTP parameters like QUERY_STRING), and these values are directly used in sprintf() to construct command strings without sufficient validation before being passed to system() for execution. Attackers can inject arbitrary commands by manipulating HTTP parameters.

Trigger conditions:
1. QUERY_STRING or other environment variables are passed via HTTP requests
2. Variable contents are not sufficiently validated
3. Directly used to construct system commands

Potential impact: Remote command execution, complete system compromise
- **Code Snippet:**
  ```
sym.imp.sprintf(puVar3 + -0x1f0,0x8b84 | 0x20000,puVar3[-1],puVar3 + 0 + -0x18);
sym.imp.system(puVar3 + -0x1f0);
  ```
- **Keywords:** command, system, sprintf
- **Notes:** Auto-curated from results directory; verify in target environment.
